<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>加密 | 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.9de76d75.js" as="script"><link rel="preload" href="/assets/js/2.98ea7a63.js" as="script"><link rel="preload" href="/assets/js/27.f47adfe7.js" as="script"><link rel="prefetch" href="/assets/js/10.fa8eed47.js"><link rel="prefetch" href="/assets/js/11.f98f25e0.js"><link rel="prefetch" href="/assets/js/12.1ab9b5a3.js"><link rel="prefetch" href="/assets/js/13.75251b00.js"><link rel="prefetch" href="/assets/js/14.b5068189.js"><link rel="prefetch" href="/assets/js/15.33abd7e1.js"><link rel="prefetch" href="/assets/js/16.34ed8053.js"><link rel="prefetch" href="/assets/js/17.b3d52ea3.js"><link rel="prefetch" href="/assets/js/18.cbe71205.js"><link rel="prefetch" href="/assets/js/19.c632cb86.js"><link rel="prefetch" href="/assets/js/20.90d9a221.js"><link rel="prefetch" href="/assets/js/21.15cb7700.js"><link rel="prefetch" href="/assets/js/22.62ea968a.js"><link rel="prefetch" href="/assets/js/23.b743fdd5.js"><link rel="prefetch" href="/assets/js/24.5d157647.js"><link rel="prefetch" href="/assets/js/25.1935fba3.js"><link rel="prefetch" href="/assets/js/26.fd22f8ee.js"><link rel="prefetch" href="/assets/js/28.d9f5719d.js"><link rel="prefetch" href="/assets/js/29.82cbf665.js"><link rel="prefetch" href="/assets/js/3.b96f613e.js"><link rel="prefetch" href="/assets/js/30.9f901f01.js"><link rel="prefetch" href="/assets/js/31.d9e2f61c.js"><link rel="prefetch" href="/assets/js/32.b14052e9.js"><link rel="prefetch" href="/assets/js/33.1b2e5efd.js"><link rel="prefetch" href="/assets/js/34.4bf7f44f.js"><link rel="prefetch" href="/assets/js/35.98d5fd2b.js"><link rel="prefetch" href="/assets/js/36.cdaf1c2f.js"><link rel="prefetch" href="/assets/js/37.a67bdb9a.js"><link rel="prefetch" href="/assets/js/38.5d856b83.js"><link rel="prefetch" href="/assets/js/39.27169c95.js"><link rel="prefetch" href="/assets/js/4.268c621c.js"><link rel="prefetch" href="/assets/js/40.8763c647.js"><link rel="prefetch" href="/assets/js/41.cd839f43.js"><link rel="prefetch" href="/assets/js/42.a97bf97a.js"><link rel="prefetch" href="/assets/js/43.fd126bb1.js"><link rel="prefetch" href="/assets/js/44.50e2b10d.js"><link rel="prefetch" href="/assets/js/45.0c29263b.js"><link rel="prefetch" href="/assets/js/46.fdee27aa.js"><link rel="prefetch" href="/assets/js/47.c7c7e966.js"><link rel="prefetch" href="/assets/js/48.80bc6f0a.js"><link rel="prefetch" href="/assets/js/49.d457b0ac.js"><link rel="prefetch" href="/assets/js/5.f577ebb9.js"><link rel="prefetch" href="/assets/js/50.cea3b0e6.js"><link rel="prefetch" href="/assets/js/51.eaab3e31.js"><link rel="prefetch" href="/assets/js/52.010a2dfb.js"><link rel="prefetch" href="/assets/js/53.3622f7b6.js"><link rel="prefetch" href="/assets/js/54.817aba2b.js"><link rel="prefetch" href="/assets/js/55.c3984ff9.js"><link rel="prefetch" href="/assets/js/56.6f20785e.js"><link rel="prefetch" href="/assets/js/57.07c7f6fc.js"><link rel="prefetch" href="/assets/js/58.4ec50d24.js"><link rel="prefetch" href="/assets/js/59.626b42b0.js"><link rel="prefetch" href="/assets/js/6.b9249342.js"><link rel="prefetch" href="/assets/js/60.ba2af5c7.js"><link rel="prefetch" href="/assets/js/61.6e22c298.js"><link rel="prefetch" href="/assets/js/62.df85ea27.js"><link rel="prefetch" href="/assets/js/63.cd3c1f6a.js"><link rel="prefetch" href="/assets/js/64.d0f75a86.js"><link rel="prefetch" href="/assets/js/65.12e0c392.js"><link rel="prefetch" href="/assets/js/66.aac422ac.js"><link rel="prefetch" href="/assets/js/67.3ff890c6.js"><link rel="prefetch" href="/assets/js/68.c6d12518.js"><link rel="prefetch" href="/assets/js/69.455e0c09.js"><link rel="prefetch" href="/assets/js/7.375eddd0.js"><link rel="prefetch" href="/assets/js/70.73d975e7.js"><link rel="prefetch" href="/assets/js/71.66528e07.js"><link rel="prefetch" href="/assets/js/72.a608a326.js"><link rel="prefetch" href="/assets/js/73.b8ed0811.js"><link rel="prefetch" href="/assets/js/74.68f4db5d.js"><link rel="prefetch" href="/assets/js/75.85059bdc.js"><link rel="prefetch" href="/assets/js/8.a04b9d9b.js"><link rel="prefetch" href="/assets/js/9.04a00c43.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS知识体系/UI视图.html" class="sidebar-link">UI视图</a></li><li><a href="/iOS知识体系/Objective-C.html" class="sidebar-link">Objective-C</a></li><li><a href="/iOS知识体系/Swift.html" class="sidebar-link">Swift</a></li><li><a href="/iOS知识体系/Runtime.html" class="sidebar-link">Runtime</a></li><li><a href="/iOS知识体系/内存管理.html" class="sidebar-link">内存管理</a></li><li><a href="/iOS知识体系/Block.html" class="sidebar-link">Block</a></li><li><a href="/iOS知识体系/多线程.html" class="sidebar-link">多线程</a></li><li><a href="/iOS知识体系/线程锁.html" class="sidebar-link">线程锁</a></li><li><a href="/iOS知识体系/RunLoop.html" class="sidebar-link">RunLoop</a></li><li><a href="/iOS知识体系/动画.html" class="sidebar-link">动画</a></li><li><a href="/iOS知识体系/数据持久化.html" class="sidebar-link">数据持久化</a></li><li><a href="/iOS知识体系/加密.html" class="active sidebar-link">加密</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS知识体系/加密.html#加密种类" class="sidebar-link">加密种类</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/加密.html#二次加密" class="sidebar-link">二次加密</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/加密.html#常用的加密方式" class="sidebar-link">常用的加密方式</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/加密.html#加密实战" class="sidebar-link">加密实战</a></li></ul></li><li><a href="/iOS知识体系/网络.html" class="sidebar-link">网络</a></li><li><a href="/iOS知识体系/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/iOS知识体系/架构&amp;框架设计.html" class="sidebar-link">架构&amp;框架设计</a></li><li><a href="/iOS知识体系/第三方库.html" class="sidebar-link">第三方库</a></li><li><a href="/iOS知识体系/ReactNative.html" class="sidebar-link">React Native</a></li><li><a href="/iOS知识体系/算法.html" class="sidebar-link">算法</a></li><li><a href="/iOS知识体系/软件优化.html" class="sidebar-link">软件优化</a></li><li><a href="/iOS知识体系/Git.html" class="sidebar-link">Git</a></li><li><a href="/iOS知识体系/iOS内核.html" class="sidebar-link">iOS内核</a></li><li><a href="/iOS知识体系/视频及音频处理.html" class="sidebar-link">视频及音频处理</a></li><li><a href="/iOS知识体系/直播类软件实现方案.html" class="sidebar-link">直播类软件实现方案</a></li><li><a href="/iOS知识体系/聊天类软件实现方案.html" class="sidebar-link">聊天类软件实现方案</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="加密"><a href="#加密" class="header-anchor">#</a> 加密</h1> <h2 id="加密种类"><a href="#加密种类" class="header-anchor">#</a> 加密种类</h2> <h3 id="非对称加密算法"><a href="#非对称加密算法" class="header-anchor">#</a> 非对称加密算法</h3> <table><thead><tr><th>名称</th> <th>成熟度</th> <th>安全性(取决于密钥长度)</th> <th>运算速度</th> <th>资源消耗</th></tr></thead> <tbody><tr><td>RSA</td> <td>高</td> <td>高</td> <td>慢</td> <td>高</td></tr> <tr><td>DSA</td> <td>高</td> <td>高</td> <td>慢</td> <td>只能用于数字签名</td></tr> <tr><td>ECC</td> <td>低</td> <td>高</td> <td>快</td> <td>低(计算量小，存储空间占用小，带宽要求低)</td></tr></tbody></table> <h3 id="对称加密算法"><a href="#对称加密算法" class="header-anchor">#</a> 对称加密算法</h3> <ul><li>AES<br>
AES为分组密码，分组密码也就是把明文分成一组一组的，每组长度相等，每次加密一组数据，知道加密完整个明文。在AES标准规范中，分组长度只能是128位，也就是说，每个分组为16个字节（每个字节8位）。密钥的长度可以使用128位、192位或256位。密钥的长度不同，推荐加密轮数也不同，如下表所示：</li></ul> <table><thead><tr><th style="text-align:center;">AES</th> <th style="text-align:center;">密钥长度（字节）</th> <th style="text-align:center;">分组长度（字节）</th> <th style="text-align:center;">加密轮数</th></tr></thead> <tbody><tr><td style="text-align:center;">AES-128</td> <td style="text-align:center;">16</td> <td style="text-align:center;">16</td> <td style="text-align:center;">10</td></tr> <tr><td style="text-align:center;">AES-192</td> <td style="text-align:center;">24</td> <td style="text-align:center;">16</td> <td style="text-align:center;">12</td></tr> <tr><td style="text-align:center;">AES-256</td> <td style="text-align:center;">32</td> <td style="text-align:center;">16</td> <td style="text-align:center;">14</td></tr></tbody></table> <p>对称加密算法比较</p> <table><thead><tr><th>名称</th> <th>密钥长度</th> <th>运算速度</th> <th>安全性</th> <th>资源消耗</th></tr></thead> <tbody><tr><td>DES</td> <td>56位</td> <td>较快</td> <td>低</td> <td>中</td></tr> <tr><td>3DES</td> <td>112位或168位</td> <td>慢</td> <td>中</td> <td>高</td></tr> <tr><td>AES</td> <td>128、192、256位</td> <td>快</td> <td>高</td> <td>低</td></tr></tbody></table> <h3 id="rsa加密算法在https中所起的作用"><a href="#rsa加密算法在https中所起的作用" class="header-anchor">#</a> RSA加密算法在HTTPS中所起的作用</h3> <p><a href="https://blog.csdn.net/xiaopang_yan/article/details/78709574" target="_blank" rel="noopener noreferrer">https流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>因为私钥只有服务器拥有，因此客户可以通过判断对方是否有私钥来判断对方是否是服务器。</li> <li>客户端通过RSA的掩护，安全的和服务器商量好一个对称加密算法和秘钥来保证后面通信过程内容的安全。</li></ul> <p>为什么不直接使用RSA来通信呢？<br>
假如服务器直接使用RSA私钥加密传输信息，任何拥有公钥的中间人都可以进行解密，不安全，所以需要通过客户端生成对称加密算法，通过RSA公钥加密将对称加密秘钥发给服务端，服务端和客户端以后就可以使用对称加密算法来进行通信，因为对称秘钥只有客户端和服务端知道。</p> <p>那客户端是怎样拿到服务端的RSA公钥的呢？<br>
如果通过服务端直接发送公钥给客户端，你怎么知道发送给你的公钥是真正的服务端发送的，而不是中间人发送的呢？问题就在于大家都能生成公钥私钥，无法确认公钥对到底是谁的。如果能够确定公钥到底是谁的，就不会有这个问题了。<br>
为了解决这个问题，数字证书出现了，它可以解决我们上面的问题，先大概看一些什么是数字证书，一个证书包含下面具体内容：</p> <ul><li>证书的发布机构</li> <li>证书的有效期</li> <li>公钥</li> <li>证书所有者</li> <li>签名所使用的算法</li> <li>指纹以及指纹算法</li></ul> <div class="language-C extra-class"><pre class="language-c"><code>“客户”<span class="token operator">-&gt;</span>“服务器”：你好

“服务器”<span class="token operator">-&gt;</span>“客户”：你好，我是服务器，这里是我的数字证书        <span class="token comment">//这里用证书代替了公钥</span>

“客户”<span class="token operator">-&gt;</span>“服务器”：向我证明你就是服务器

“服务器”<span class="token operator">-&gt;</span>“客户”：你好，我是服务器 <span class="token punctuation">{</span>你好，我是服务器<span class="token punctuation">}</span><span class="token punctuation">[</span>私钥<span class="token operator">|</span>RSA<span class="token punctuation">]</span>
</code></pre></div><p>服务器把自己的证书发给了客户，而不是发送公钥。客户可以根据证书校验这个证书到底是不是服务器的，也就是能校验这个证书的所有者是不是服务器，从而确认这个证书中的公钥的确是服务器的。后面的过程就是服务器通过RSA私钥加密一段内容联通明文一起发给客户，客户把加密内容用数字证书中的公钥解密和明文对比，如果一直就确实是服务器，然后双方协商一个对称加密来保证通信过程的安全。</p> <h3 id="签名"><a href="#签名" class="header-anchor">#</a> 签名</h3> <p>签名就是在信息的后面再加上一段内容，可以证明信息没有被修改过，怎么样可以达到这个效果呢？一般是对信息做一个hash计算得到一个hash值，注意这个过程是不可逆的，也就是说无法通过hash值得出原来的信息内容。在把信息发送出去时，把这个hash值加密后作为一个签名和信息一起发送出去。接收方在收到信息后，会重新计算信息的hash值，所以只要内容一被修改，根据信息内容计算的hash值就会变化。当然，不怀好意的人也可以修改信息内容的同时也修改hash值，从而让它们可以像匹配，为了防止这种情况，hash值一般都会加密后(也就是签名)再和信息一起发送，以保证这个hash值不被修改。至于如何让别人可以解密这个签名，这个过程涉及到数字证书等概念。</p> <h2 id="二次加密"><a href="#二次加密" class="header-anchor">#</a> 二次加密</h2> <p>https 能保证的是连接的安全，当我们打开网站的时候，是需要和服务器进行通信的，那么 https 能够保证在通信时数据传输是安全的。</p> <p>如果我们打开一个网页，在网址的前面有标明&quot;https&quot;的话，那么就说明这个网站有证书并且有进行加密的操作。但是，不少钓鱼网页其实也可以使用 https，这就说明了 https 并不能保证网站本身是安全的。举个例子，如果你在一个网页上输入账号密码的话，使用 https 的网页能够保证你的账号密码在传到网站服务器的过程中不会被其他的东西干扰或者盗取，但是，你输入的账号密码却有可能被你正在访问的这个网页盗用。</p> <p>再举个例子：移动端手机种了木马，终端被攻击了，那么对于传输通道进行加密就毫无意义，试想人家都跑到你家里面去了，所有的东西在内存跟硬盘里面都有，再进行网络监听毫无意义。</p> <p>所以 https 本身是安全的，至少在网络传输过程中，能够保证传输数据的完整性和一致性。但是并不代表它的宿主是安全的，所以如果是金融类，支付类等对安全等级要求很高的软件，最好进行二次加密。</p> <p>有些金融类的app除了使用HTTPS之外还会对数据进行二次加密，下面对aes进行分析一下：<br>
如果是服务端用rsa私钥加密aes密钥，其他任何人都有公钥，不能由服务端生成aes密钥<br>
如果是服务端用rsa公钥加密aes密钥，只有客户端有私钥，客户端私钥存哪里呢？不能由服务端生成aes密钥<br>
如果是客户端用rsa公钥加密aes密钥，只有服务端能解，可以由客户端生成aes密钥<br>
如果是客户端用rsa私钥加密aes密钥，又会有私钥怎么存的问题。</p> <p>所以aes密钥是客户端动态生成的，而不是服务端，原理跟https一样</p> <h2 id="常用的加密方式"><a href="#常用的加密方式" class="header-anchor">#</a> 常用的加密方式</h2> <p>常见加密算法</p> <ol><li>DES（Data Encryption Standard）：对称算法，数据加密标准，速度较快，适用于加密大量数据的场合；</li> <li>3DES（Triple DES）：是基于DES的对称算法，对一块数据用三个不同的密钥进行三次加密，强度更高；</li> <li>RC2和RC4：对称算法，用变长密钥对大量数据进行加密，比 DES 快；</li> <li>IDEA（International Data Encryption Algorithm）国际数据加密算法，使用 128 位密钥提供非常强的安全性；</li> <li>RSA：由 RSA 公司发明，是一个支持变长密钥的公共密钥算法，需要加密的文件块的长度也是可变的，非对称算法；</li> <li>DSA（Digital Signature Algorithm）：数字签名算法，是一种标准的 DSS（数字签名标准），严格来说不算加密算法；</li> <li>AES（Advanced Encryption Standard）：高级加密标准，对称算法，是下一代的加密算法标准，速度快，安全级别高，在21世纪AES 标准的一个实现是 Rijndael 算法；</li> <li>BLOWFISH，它使用变长的密钥，长度可达448位，运行速度很快；</li> <li>MD5：严格来说不算加密算法，只能说是摘要算法；</li> <li>PKCS:The Public-Key Cryptography Standards (PKCS)是由美国RSA数据安全公司及其合作伙伴制定的一组公钥密码学标准，其中包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等方面的一系列相关协议。</li> <li>SSF33，SSF28，SCB2(SM1)：国家密码局的隐蔽不公开的商用算法，在国内民用和商用的，除这些都不容许使用外，其他的都可以使用；</li> <li>ECC（Elliptic Curves Cryptography）：椭圆曲线密码编码学。</li> <li>TEA(Tiny Encryption Algorithm)简单高效的加密算法，加密解密速度快，实现简单。但安全性不如DES，QQ一直用tea加密</li> <li>TLS 1.3不在支持RSA静态密钥交换，可以使用带有前向安全的Diffie-Hellman（迪菲赫尔曼）。</li></ol> <h2 id="加密实战"><a href="#加密实战" class="header-anchor">#</a> 加密实战</h2> <p>AES<br>
AES加密有四种工作模式：ECB/CBC/CFB/OFB，其中iOS支持CBC(KCCOptionPKCS7Padding)和ECB(KCCOptionECBMode)</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/iOS知识体系/数据持久化.html" class="prev">
        数据持久化
      </a></span> <span class="next"><a href="/iOS知识体系/网络.html">
        网络
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9de76d75.js" defer></script><script src="/assets/js/2.98ea7a63.js" defer></script><script src="/assets/js/27.f47adfe7.js" defer></script>
  </body>
</html>
