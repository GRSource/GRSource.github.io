<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>软件优化 | 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.9de76d75.js" as="script"><link rel="preload" href="/assets/js/2.98ea7a63.js" as="script"><link rel="preload" href="/assets/js/38.5d856b83.js" as="script"><link rel="prefetch" href="/assets/js/10.fa8eed47.js"><link rel="prefetch" href="/assets/js/11.f98f25e0.js"><link rel="prefetch" href="/assets/js/12.1ab9b5a3.js"><link rel="prefetch" href="/assets/js/13.75251b00.js"><link rel="prefetch" href="/assets/js/14.b5068189.js"><link rel="prefetch" href="/assets/js/15.33abd7e1.js"><link rel="prefetch" href="/assets/js/16.34ed8053.js"><link rel="prefetch" href="/assets/js/17.b3d52ea3.js"><link rel="prefetch" href="/assets/js/18.cbe71205.js"><link rel="prefetch" href="/assets/js/19.c632cb86.js"><link rel="prefetch" href="/assets/js/20.90d9a221.js"><link rel="prefetch" href="/assets/js/21.15cb7700.js"><link rel="prefetch" href="/assets/js/22.62ea968a.js"><link rel="prefetch" href="/assets/js/23.b743fdd5.js"><link rel="prefetch" href="/assets/js/24.5d157647.js"><link rel="prefetch" href="/assets/js/25.1935fba3.js"><link rel="prefetch" href="/assets/js/26.fd22f8ee.js"><link rel="prefetch" href="/assets/js/27.f47adfe7.js"><link rel="prefetch" href="/assets/js/28.d9f5719d.js"><link rel="prefetch" href="/assets/js/29.82cbf665.js"><link rel="prefetch" href="/assets/js/3.b96f613e.js"><link rel="prefetch" href="/assets/js/30.9f901f01.js"><link rel="prefetch" href="/assets/js/31.d9e2f61c.js"><link rel="prefetch" href="/assets/js/32.b14052e9.js"><link rel="prefetch" href="/assets/js/33.1b2e5efd.js"><link rel="prefetch" href="/assets/js/34.4bf7f44f.js"><link rel="prefetch" href="/assets/js/35.98d5fd2b.js"><link rel="prefetch" href="/assets/js/36.cdaf1c2f.js"><link rel="prefetch" href="/assets/js/37.a67bdb9a.js"><link rel="prefetch" href="/assets/js/39.27169c95.js"><link rel="prefetch" href="/assets/js/4.268c621c.js"><link rel="prefetch" href="/assets/js/40.8763c647.js"><link rel="prefetch" href="/assets/js/41.cd839f43.js"><link rel="prefetch" href="/assets/js/42.a97bf97a.js"><link rel="prefetch" href="/assets/js/43.fd126bb1.js"><link rel="prefetch" href="/assets/js/44.50e2b10d.js"><link rel="prefetch" href="/assets/js/45.0c29263b.js"><link rel="prefetch" href="/assets/js/46.fdee27aa.js"><link rel="prefetch" href="/assets/js/47.c7c7e966.js"><link rel="prefetch" href="/assets/js/48.80bc6f0a.js"><link rel="prefetch" href="/assets/js/49.d457b0ac.js"><link rel="prefetch" href="/assets/js/5.f577ebb9.js"><link rel="prefetch" href="/assets/js/50.cea3b0e6.js"><link rel="prefetch" href="/assets/js/51.eaab3e31.js"><link rel="prefetch" href="/assets/js/52.010a2dfb.js"><link rel="prefetch" href="/assets/js/53.3622f7b6.js"><link rel="prefetch" href="/assets/js/54.817aba2b.js"><link rel="prefetch" href="/assets/js/55.c3984ff9.js"><link rel="prefetch" href="/assets/js/56.6f20785e.js"><link rel="prefetch" href="/assets/js/57.07c7f6fc.js"><link rel="prefetch" href="/assets/js/58.4ec50d24.js"><link rel="prefetch" href="/assets/js/59.626b42b0.js"><link rel="prefetch" href="/assets/js/6.b9249342.js"><link rel="prefetch" href="/assets/js/60.ba2af5c7.js"><link rel="prefetch" href="/assets/js/61.6e22c298.js"><link rel="prefetch" href="/assets/js/62.df85ea27.js"><link rel="prefetch" href="/assets/js/63.cd3c1f6a.js"><link rel="prefetch" href="/assets/js/64.d0f75a86.js"><link rel="prefetch" href="/assets/js/65.12e0c392.js"><link rel="prefetch" href="/assets/js/66.aac422ac.js"><link rel="prefetch" href="/assets/js/67.3ff890c6.js"><link rel="prefetch" href="/assets/js/68.c6d12518.js"><link rel="prefetch" href="/assets/js/69.455e0c09.js"><link rel="prefetch" href="/assets/js/7.375eddd0.js"><link rel="prefetch" href="/assets/js/70.73d975e7.js"><link rel="prefetch" href="/assets/js/71.66528e07.js"><link rel="prefetch" href="/assets/js/72.a608a326.js"><link rel="prefetch" href="/assets/js/73.b8ed0811.js"><link rel="prefetch" href="/assets/js/74.68f4db5d.js"><link rel="prefetch" href="/assets/js/75.85059bdc.js"><link rel="prefetch" href="/assets/js/8.a04b9d9b.js"><link rel="prefetch" href="/assets/js/9.04a00c43.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS知识体系/UI视图.html" class="sidebar-link">UI视图</a></li><li><a href="/iOS知识体系/Objective-C.html" class="sidebar-link">Objective-C</a></li><li><a href="/iOS知识体系/Swift.html" class="sidebar-link">Swift</a></li><li><a href="/iOS知识体系/Runtime.html" class="sidebar-link">Runtime</a></li><li><a href="/iOS知识体系/内存管理.html" class="sidebar-link">内存管理</a></li><li><a href="/iOS知识体系/Block.html" class="sidebar-link">Block</a></li><li><a href="/iOS知识体系/多线程.html" class="sidebar-link">多线程</a></li><li><a href="/iOS知识体系/线程锁.html" class="sidebar-link">线程锁</a></li><li><a href="/iOS知识体系/RunLoop.html" class="sidebar-link">RunLoop</a></li><li><a href="/iOS知识体系/动画.html" class="sidebar-link">动画</a></li><li><a href="/iOS知识体系/数据持久化.html" class="sidebar-link">数据持久化</a></li><li><a href="/iOS知识体系/加密.html" class="sidebar-link">加密</a></li><li><a href="/iOS知识体系/网络.html" class="sidebar-link">网络</a></li><li><a href="/iOS知识体系/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/iOS知识体系/架构&amp;框架设计.html" class="sidebar-link">架构&amp;框架设计</a></li><li><a href="/iOS知识体系/第三方库.html" class="sidebar-link">第三方库</a></li><li><a href="/iOS知识体系/ReactNative.html" class="sidebar-link">React Native</a></li><li><a href="/iOS知识体系/算法.html" class="sidebar-link">算法</a></li><li><a href="/iOS知识体系/软件优化.html" class="active sidebar-link">软件优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS知识体系/软件优化.html#一、哪些优化方案及如何使用" class="sidebar-link">一、哪些优化方案及如何使用</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/软件优化.html#二、性能检测" class="sidebar-link">二、性能检测</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/软件优化.html#三、性能优化" class="sidebar-link">三、性能优化</a></li></ul></li><li><a href="/iOS知识体系/Git.html" class="sidebar-link">Git</a></li><li><a href="/iOS知识体系/iOS内核.html" class="sidebar-link">iOS内核</a></li><li><a href="/iOS知识体系/视频及音频处理.html" class="sidebar-link">视频及音频处理</a></li><li><a href="/iOS知识体系/直播类软件实现方案.html" class="sidebar-link">直播类软件实现方案</a></li><li><a href="/iOS知识体系/聊天类软件实现方案.html" class="sidebar-link">聊天类软件实现方案</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="软件优化"><a href="#软件优化" class="header-anchor">#</a> 软件优化</h1> <h2 id="一、哪些优化方案及如何使用"><a href="#一、哪些优化方案及如何使用" class="header-anchor">#</a> 一、哪些优化方案及如何使用</h2> <h2 id="二、性能检测"><a href="#二、性能检测" class="header-anchor">#</a> 二、性能检测</h2> <h3 id="_1-网络层"><a href="#_1-网络层" class="header-anchor">#</a> 1.网络层</h3> <h4 id="urlprotocol"><a href="#urlprotocol" class="header-anchor">#</a> URLProtocol</h4> <h4 id="hook"><a href="#hook" class="header-anchor">#</a> hook</h4> <h3 id="_2-采集"><a href="#_2-采集" class="header-anchor">#</a> 2.采集</h3> <h4 id="cpu"><a href="#cpu" class="header-anchor">#</a> CPU</h4> <h4 id="内存消耗"><a href="#内存消耗" class="header-anchor">#</a> 内存消耗</h4> <h4 id="调用堆栈"><a href="#调用堆栈" class="header-anchor">#</a> 调用堆栈</h4> <h4 id="设备信息"><a href="#设备信息" class="header-anchor">#</a> 设备信息</h4> <h3 id="_3-内存监控"><a href="#_3-内存监控" class="header-anchor">#</a> 3.内存监控</h3> <h4 id="内存使用"><a href="#内存使用" class="header-anchor">#</a> 内存使用</h4> <h4 id="内存泄漏"><a href="#内存泄漏" class="header-anchor">#</a> 内存泄漏</h4> <h3 id="_4-ui"><a href="#_4-ui" class="header-anchor">#</a> 4.UI</h3> <h4 id="fps"><a href="#fps" class="header-anchor">#</a> FPS</h4> <h4 id="卡顿检测"><a href="#卡顿检测" class="header-anchor">#</a> 卡顿检测</h4> <h4 id="子线程操作ui"><a href="#子线程操作ui" class="header-anchor">#</a> 子线程操作UI</h4> <h3 id="_5-crash"><a href="#_5-crash" class="header-anchor">#</a> 5.Crash</h3> <h4 id="mach异常"><a href="#mach异常" class="header-anchor">#</a> Mach异常</h4> <h4 id="unix异常"><a href="#unix异常" class="header-anchor">#</a> UNIX异常</h4> <h4 id="objective-c异常"><a href="#objective-c异常" class="header-anchor">#</a> Objective-C异常</h4> <h4 id="其他判定"><a href="#其他判定" class="header-anchor">#</a> 其他判定</h4> <h4 id="crash解析"><a href="#crash解析" class="header-anchor">#</a> crash解析</h4> <h3 id="_6-启动时间"><a href="#_6-启动时间" class="header-anchor">#</a> 6.启动时间</h3> <h4 id="main之前"><a href="#main之前" class="header-anchor">#</a> main之前</h4> <h4 id="main之后"><a href="#main之后" class="header-anchor">#</a> main之后</h4> <h2 id="三、性能优化"><a href="#三、性能优化" class="header-anchor">#</a> 三、性能优化</h2> <h3 id="_1-源代码"><a href="#_1-源代码" class="header-anchor">#</a> 1.源代码</h3> <h4 id="代码重构"><a href="#代码重构" class="header-anchor">#</a> 代码重构</h4> <h3 id="_2-xcode"><a href="#_2-xcode" class="header-anchor">#</a> 2.Xcode</h3> <h4 id="build-setting"><a href="#build-setting" class="header-anchor">#</a> Build Setting</h4> <h4 id="静态检查"><a href="#静态检查" class="header-anchor">#</a> 静态检查</h4> <h4 id="运行时检测"><a href="#运行时检测" class="header-anchor">#</a> 运行时检测</h4> <h3 id="_3-gcd"><a href="#_3-gcd" class="header-anchor">#</a> 3.GCD</h3> <h3 id="_4-i-o"><a href="#_4-i-o" class="header-anchor">#</a> 4.I/O</h3> <h3 id="_5-内存"><a href="#_5-内存" class="header-anchor">#</a> 5.内存</h3> <h3 id="_6-网络层"><a href="#_6-网络层" class="header-anchor">#</a> 6.网络层</h3> <h3 id="_7-耗电"><a href="#_7-耗电" class="header-anchor">#</a> 7.耗电</h3> <h3 id="_8-ui优化"><a href="#_8-ui优化" class="header-anchor">#</a> 8.UI优化</h3> <h3 id="_9-启动速度"><a href="#_9-启动速度" class="header-anchor">#</a> 9.启动速度</h3> <h3 id="_10-web"><a href="#_10-web" class="header-anchor">#</a> 10.Web</h3> <h3 id="_11-包体积"><a href="#_11-包体积" class="header-anchor">#</a> 11.包体积</h3> <h3 id="_12-图层优化"><a href="#_12-图层优化" class="header-anchor">#</a> 12.图层优化</h3> <p>Xcode -&gt; View Debugging -&gt; Rendering -&gt; Color Blended Layers可以看到渲染时view的混合状态，尽量给UIView设置背景色不透明。UIImageView不仅需要设置背景色不透明，还需要设置图片的alpha通过为否。</p> <p>Color Hits Green and Misses Red<br>
表示如果进行了光栅化，则layer直接从位图缓冲当中获取，而不是重新渲染，对于一些比较耗时的layer，如阴影等效果，我们可以启用光栅化，以减小渲染消耗的时间，因为光栅化会进行缓存的写入和读取，也会有一定的资源消耗，所以并不是所有的layer都需要光栅化。</p> <p>Color Copied Images<br>
表示png或者jpg图片加压后，如果GPU不支持该种图片格式，CPU就进行转码操作，会对性能有一定的消耗。</p> <p>Color Misaligned Images<br>
表示如果图片需要缩放则标记为黄色，如果没有像素对齐则标记为紫色</p> <p>Color Offscreen-Rendered Yellow<br>
检测触发离屏渲染，为黄色就说明有离屏渲染。触发离屏渲染的情况有：</p> <ol><li>重写drawRect方法</li> <li>mask、shadow等</li> <li>layer.shouldRasterize = true</li> <li>设置圆角并不会导致离屏渲染，结合maskToBounds会导致离屏渲染，尽量避免滑动时设置圆角，如果必须设置圆角，可以启用光栅化，将圆角缓存起来</li></ol> <p>Flash updated Regions<br>
变化区域，对于布局没有改变的区别，不应该进行刷新，刷的地方会显示黄色</p> <p>总结：</p> <ol><li>避免图层混合</li> <li>避免临时转换，确保图片和frame大小一致</li> <li>慎用离屏渲染</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/iOS知识体系/算法.html" class="prev">
        算法
      </a></span> <span class="next"><a href="/iOS知识体系/Git.html">
        Git
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9de76d75.js" defer></script><script src="/assets/js/2.98ea7a63.js" defer></script><script src="/assets/js/38.5d856b83.js" defer></script>
  </body>
</html>
