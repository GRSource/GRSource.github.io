<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>UI视图 | 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.9de76d75.js" as="script"><link rel="preload" href="/assets/js/2.98ea7a63.js" as="script"><link rel="preload" href="/assets/js/25.1935fba3.js" as="script"><link rel="prefetch" href="/assets/js/10.fa8eed47.js"><link rel="prefetch" href="/assets/js/11.f98f25e0.js"><link rel="prefetch" href="/assets/js/12.1ab9b5a3.js"><link rel="prefetch" href="/assets/js/13.75251b00.js"><link rel="prefetch" href="/assets/js/14.b5068189.js"><link rel="prefetch" href="/assets/js/15.33abd7e1.js"><link rel="prefetch" href="/assets/js/16.34ed8053.js"><link rel="prefetch" href="/assets/js/17.b3d52ea3.js"><link rel="prefetch" href="/assets/js/18.cbe71205.js"><link rel="prefetch" href="/assets/js/19.c632cb86.js"><link rel="prefetch" href="/assets/js/20.90d9a221.js"><link rel="prefetch" href="/assets/js/21.15cb7700.js"><link rel="prefetch" href="/assets/js/22.62ea968a.js"><link rel="prefetch" href="/assets/js/23.b743fdd5.js"><link rel="prefetch" href="/assets/js/24.5d157647.js"><link rel="prefetch" href="/assets/js/26.fd22f8ee.js"><link rel="prefetch" href="/assets/js/27.f47adfe7.js"><link rel="prefetch" href="/assets/js/28.d9f5719d.js"><link rel="prefetch" href="/assets/js/29.82cbf665.js"><link rel="prefetch" href="/assets/js/3.b96f613e.js"><link rel="prefetch" href="/assets/js/30.9f901f01.js"><link rel="prefetch" href="/assets/js/31.d9e2f61c.js"><link rel="prefetch" href="/assets/js/32.b14052e9.js"><link rel="prefetch" href="/assets/js/33.1b2e5efd.js"><link rel="prefetch" href="/assets/js/34.4bf7f44f.js"><link rel="prefetch" href="/assets/js/35.98d5fd2b.js"><link rel="prefetch" href="/assets/js/36.cdaf1c2f.js"><link rel="prefetch" href="/assets/js/37.a67bdb9a.js"><link rel="prefetch" href="/assets/js/38.5d856b83.js"><link rel="prefetch" href="/assets/js/39.27169c95.js"><link rel="prefetch" href="/assets/js/4.268c621c.js"><link rel="prefetch" href="/assets/js/40.8763c647.js"><link rel="prefetch" href="/assets/js/41.cd839f43.js"><link rel="prefetch" href="/assets/js/42.a97bf97a.js"><link rel="prefetch" href="/assets/js/43.fd126bb1.js"><link rel="prefetch" href="/assets/js/44.50e2b10d.js"><link rel="prefetch" href="/assets/js/45.0c29263b.js"><link rel="prefetch" href="/assets/js/46.fdee27aa.js"><link rel="prefetch" href="/assets/js/47.c7c7e966.js"><link rel="prefetch" href="/assets/js/48.80bc6f0a.js"><link rel="prefetch" href="/assets/js/49.d457b0ac.js"><link rel="prefetch" href="/assets/js/5.f577ebb9.js"><link rel="prefetch" href="/assets/js/50.cea3b0e6.js"><link rel="prefetch" href="/assets/js/51.eaab3e31.js"><link rel="prefetch" href="/assets/js/52.010a2dfb.js"><link rel="prefetch" href="/assets/js/53.3622f7b6.js"><link rel="prefetch" href="/assets/js/54.817aba2b.js"><link rel="prefetch" href="/assets/js/55.c3984ff9.js"><link rel="prefetch" href="/assets/js/56.6f20785e.js"><link rel="prefetch" href="/assets/js/57.07c7f6fc.js"><link rel="prefetch" href="/assets/js/58.4ec50d24.js"><link rel="prefetch" href="/assets/js/59.626b42b0.js"><link rel="prefetch" href="/assets/js/6.b9249342.js"><link rel="prefetch" href="/assets/js/60.ba2af5c7.js"><link rel="prefetch" href="/assets/js/61.6e22c298.js"><link rel="prefetch" href="/assets/js/62.df85ea27.js"><link rel="prefetch" href="/assets/js/63.cd3c1f6a.js"><link rel="prefetch" href="/assets/js/64.d0f75a86.js"><link rel="prefetch" href="/assets/js/65.12e0c392.js"><link rel="prefetch" href="/assets/js/66.aac422ac.js"><link rel="prefetch" href="/assets/js/67.3ff890c6.js"><link rel="prefetch" href="/assets/js/68.c6d12518.js"><link rel="prefetch" href="/assets/js/69.455e0c09.js"><link rel="prefetch" href="/assets/js/7.375eddd0.js"><link rel="prefetch" href="/assets/js/70.73d975e7.js"><link rel="prefetch" href="/assets/js/71.66528e07.js"><link rel="prefetch" href="/assets/js/72.a608a326.js"><link rel="prefetch" href="/assets/js/73.b8ed0811.js"><link rel="prefetch" href="/assets/js/74.68f4db5d.js"><link rel="prefetch" href="/assets/js/75.85059bdc.js"><link rel="prefetch" href="/assets/js/8.a04b9d9b.js"><link rel="prefetch" href="/assets/js/9.04a00c43.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS知识体系/UI视图.html" class="active sidebar-link">UI视图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS知识体系/UI视图.html#ui事件传递" class="sidebar-link">UI事件传递</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/UI视图.html#二、ui事件响应" class="sidebar-link">二、UI事件响应</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/UI视图.html#三、uitableview卡顿原因及优化方案" class="sidebar-link">三、UITableView卡顿原因及优化方案</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/UI视图.html#四、异步绘制" class="sidebar-link">四、异步绘制</a></li><li class="sidebar-sub-header"><a href="/iOS知识体系/UI视图.html#离屏渲染" class="sidebar-link">离屏渲染</a></li></ul></li><li><a href="/iOS知识体系/Objective-C.html" class="sidebar-link">Objective-C</a></li><li><a href="/iOS知识体系/Swift.html" class="sidebar-link">Swift</a></li><li><a href="/iOS知识体系/Runtime.html" class="sidebar-link">Runtime</a></li><li><a href="/iOS知识体系/内存管理.html" class="sidebar-link">内存管理</a></li><li><a href="/iOS知识体系/Block.html" class="sidebar-link">Block</a></li><li><a href="/iOS知识体系/多线程.html" class="sidebar-link">多线程</a></li><li><a href="/iOS知识体系/线程锁.html" class="sidebar-link">线程锁</a></li><li><a href="/iOS知识体系/RunLoop.html" class="sidebar-link">RunLoop</a></li><li><a href="/iOS知识体系/动画.html" class="sidebar-link">动画</a></li><li><a href="/iOS知识体系/数据持久化.html" class="sidebar-link">数据持久化</a></li><li><a href="/iOS知识体系/加密.html" class="sidebar-link">加密</a></li><li><a href="/iOS知识体系/网络.html" class="sidebar-link">网络</a></li><li><a href="/iOS知识体系/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/iOS知识体系/架构&amp;框架设计.html" class="sidebar-link">架构&amp;框架设计</a></li><li><a href="/iOS知识体系/第三方库.html" class="sidebar-link">第三方库</a></li><li><a href="/iOS知识体系/ReactNative.html" class="sidebar-link">React Native</a></li><li><a href="/iOS知识体系/算法.html" class="sidebar-link">算法</a></li><li><a href="/iOS知识体系/软件优化.html" class="sidebar-link">软件优化</a></li><li><a href="/iOS知识体系/Git.html" class="sidebar-link">Git</a></li><li><a href="/iOS知识体系/iOS内核.html" class="sidebar-link">iOS内核</a></li><li><a href="/iOS知识体系/视频及音频处理.html" class="sidebar-link">视频及音频处理</a></li><li><a href="/iOS知识体系/直播类软件实现方案.html" class="sidebar-link">直播类软件实现方案</a></li><li><a href="/iOS知识体系/聊天类软件实现方案.html" class="sidebar-link">聊天类软件实现方案</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ui视图"><a href="#ui视图" class="header-anchor">#</a> UI视图</h1> <h2 id="ui事件传递"><a href="#ui事件传递" class="header-anchor">#</a> UI事件传递</h2> <p><code>UIView</code>和<code>CALayer</code>的区别是什么？</p> <ol><li><code>UIView</code>可以响应事件，<code>CALayer</code>不可以，因为<code>UIView</code>继承自<code>UIResponsder</code>，而<code>CALayer</code>直接继承自<code>NSObject</code>，并没有相应的处理事件的接口。</li> <li><code>View</code>的<code>frame</code>、<code>center</code>和<code>bounds</code>只是简单的返回<code>Layer</code>的<code>frame</code>、<code>center</code>和<code>bounds</code></li> <li><code>UIView</code>主要对显示内容的管理，而<code>CALayer</code>主要侧重显示内容的绘制</li> <li><code>CALayer</code>修改属性时默认会产生隐式动画，时间为0.25s，但在为<code>UIView</code>当中的<code>CALayer</code>做动画时，<code>View</code>作为<code>Layer</code>的代理，<code>Layer</code>需要通过<code>actionForLayer:forKey:</code>向<code>View</code>请求相应的动画<code>action</code>。</li></ol> <p>UI事件的传递机制是什么样的？</p> <ol><li>当iOS程序发生触摸事件后，系统会将事件加入到<code>UIApplication</code>管理的一个任务队列中</li> <li><code>UIApplication</code>将处于任务队列最前端的事件向下分发给<code>UIWindow</code></li> <li><code>UIWindow</code>将事件下发给<code>UIView</code></li> <li><code>UIView</code>通过<code>hitTest:withEvent:</code>来判断自己是否能处理事件(即触点是否在自身范围之内)，如果能，那么继续采用倒序的方式遍历它的子视图，一直循环下去，直到找到最终能处理事件的视图</li> <li>如果遍历完之后仍然未找到处理事件的子视图，那么自己就是事件的处理者</li> <li>如果自己也不能处理，那么将不做任何处理。</li></ol> <p><code>UIView</code>不接受事件处理的情况有三种：</p> <ol><li><code>alpha</code> &lt; 0.01</li> <li><code>userInteractionEnabled</code> = NO</li> <li><code>hidden</code> = YES</li></ol> <h2 id="二、ui事件响应"><a href="#二、ui事件响应" class="header-anchor">#</a> 二、UI事件响应</h2> <p>问1：UI事件的响应机制是什么样的？<br>
通过hitTest:withEvent:找第一响应者之后，如果该响应者没有处理该事件，那么事件会沿着响应链向上传递，依次为父视图、视图控制器、UIWindow、UIApplication，如果UIApplication也不处理，那就将该事件丢弃</p> <h2 id="三、uitableview卡顿原因及优化方案"><a href="#三、uitableview卡顿原因及优化方案" class="header-anchor">#</a> 三、UITableView卡顿原因及优化方案</h2> <p>问1：卡顿原因是什么及如何优化？<br>
1.cell没有重用，在数据量比较大时，如果没有重用就会堆积很多cell<br>
2.避免cell重新布局<br>
3.提前计算并缓存cell的属性及内容<br>
4.减少cell中控件的数量<br>
5.不要使用ClearColor，渲染耗时比较长<br>
6.使用局部刷新<br>
7.加载网络数据、下载图片，使用异步加载并缓存<br>
8.少使用addSubView给cell动态添加view<br>
9.不要实现无用的代理方法<br>
10.缓存行高<br>
11.不要做多余的绘制工作，比如在drawRect范围之外绘制<br>
12.采用异步绘制</p> <h2 id="四、异步绘制"><a href="#四、异步绘制" class="header-anchor">#</a> 四、异步绘制</h2> <p>实现displayLayer:代理方法，自己生成对应的bitmap，将bitmap设置为layer.contents属性的值</p> <h2 id="离屏渲染"><a href="#离屏渲染" class="header-anchor">#</a> <strong>离屏渲染</strong></h2> <p>问1：什么是在屏渲染？<br>
在屏渲染指的是GPU在当前用于显示的屏幕缓冲区中进行渲染操作<br>
问2：什么是离屏渲染？离屏渲染是怎么造成的？<br>
离屏渲染指的是GPU在当前屏幕缓冲区以外开辟一个新的缓存区进行渲染操作。
当我们指定了UI视图的某些属性，标记为它在位域合成之前不能用于当前屏幕直接显示的时候，就会触发离屏渲染。比如说圆角和maskToBounds结合使用时、蒙版、阴影、光栅化。<br>
问3：为何要避免？<br>
触发离屏渲染的时候会增加GPU的工作量，而增加了GPU的工作量很有可能导致CPU和GPU总耗时加起来超过16.7毫秒，那么就可能导致UI的卡顿和掉帧，所以我们需要避免离屏渲染。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/iOS知识体系/Objective-C.html">
        Objective-C
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9de76d75.js" defer></script><script src="/assets/js/2.98ea7a63.js" defer></script><script src="/assets/js/25.1935fba3.js" defer></script>
  </body>
</html>
