<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>音频常识 | 文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.9de76d75.js" as="script"><link rel="preload" href="/assets/js/2.98ea7a63.js" as="script"><link rel="preload" href="/assets/js/75.85059bdc.js" as="script"><link rel="prefetch" href="/assets/js/10.fa8eed47.js"><link rel="prefetch" href="/assets/js/11.f98f25e0.js"><link rel="prefetch" href="/assets/js/12.1ab9b5a3.js"><link rel="prefetch" href="/assets/js/13.75251b00.js"><link rel="prefetch" href="/assets/js/14.b5068189.js"><link rel="prefetch" href="/assets/js/15.33abd7e1.js"><link rel="prefetch" href="/assets/js/16.34ed8053.js"><link rel="prefetch" href="/assets/js/17.b3d52ea3.js"><link rel="prefetch" href="/assets/js/18.cbe71205.js"><link rel="prefetch" href="/assets/js/19.c632cb86.js"><link rel="prefetch" href="/assets/js/20.90d9a221.js"><link rel="prefetch" href="/assets/js/21.15cb7700.js"><link rel="prefetch" href="/assets/js/22.62ea968a.js"><link rel="prefetch" href="/assets/js/23.b743fdd5.js"><link rel="prefetch" href="/assets/js/24.5d157647.js"><link rel="prefetch" href="/assets/js/25.1935fba3.js"><link rel="prefetch" href="/assets/js/26.fd22f8ee.js"><link rel="prefetch" href="/assets/js/27.f47adfe7.js"><link rel="prefetch" href="/assets/js/28.d9f5719d.js"><link rel="prefetch" href="/assets/js/29.82cbf665.js"><link rel="prefetch" href="/assets/js/3.b96f613e.js"><link rel="prefetch" href="/assets/js/30.9f901f01.js"><link rel="prefetch" href="/assets/js/31.d9e2f61c.js"><link rel="prefetch" href="/assets/js/32.b14052e9.js"><link rel="prefetch" href="/assets/js/33.1b2e5efd.js"><link rel="prefetch" href="/assets/js/34.4bf7f44f.js"><link rel="prefetch" href="/assets/js/35.98d5fd2b.js"><link rel="prefetch" href="/assets/js/36.cdaf1c2f.js"><link rel="prefetch" href="/assets/js/37.a67bdb9a.js"><link rel="prefetch" href="/assets/js/38.5d856b83.js"><link rel="prefetch" href="/assets/js/39.27169c95.js"><link rel="prefetch" href="/assets/js/4.268c621c.js"><link rel="prefetch" href="/assets/js/40.8763c647.js"><link rel="prefetch" href="/assets/js/41.cd839f43.js"><link rel="prefetch" href="/assets/js/42.a97bf97a.js"><link rel="prefetch" href="/assets/js/43.fd126bb1.js"><link rel="prefetch" href="/assets/js/44.50e2b10d.js"><link rel="prefetch" href="/assets/js/45.0c29263b.js"><link rel="prefetch" href="/assets/js/46.fdee27aa.js"><link rel="prefetch" href="/assets/js/47.c7c7e966.js"><link rel="prefetch" href="/assets/js/48.80bc6f0a.js"><link rel="prefetch" href="/assets/js/49.d457b0ac.js"><link rel="prefetch" href="/assets/js/5.f577ebb9.js"><link rel="prefetch" href="/assets/js/50.cea3b0e6.js"><link rel="prefetch" href="/assets/js/51.eaab3e31.js"><link rel="prefetch" href="/assets/js/52.010a2dfb.js"><link rel="prefetch" href="/assets/js/53.3622f7b6.js"><link rel="prefetch" href="/assets/js/54.817aba2b.js"><link rel="prefetch" href="/assets/js/55.c3984ff9.js"><link rel="prefetch" href="/assets/js/56.6f20785e.js"><link rel="prefetch" href="/assets/js/57.07c7f6fc.js"><link rel="prefetch" href="/assets/js/58.4ec50d24.js"><link rel="prefetch" href="/assets/js/59.626b42b0.js"><link rel="prefetch" href="/assets/js/6.b9249342.js"><link rel="prefetch" href="/assets/js/60.ba2af5c7.js"><link rel="prefetch" href="/assets/js/61.6e22c298.js"><link rel="prefetch" href="/assets/js/62.df85ea27.js"><link rel="prefetch" href="/assets/js/63.cd3c1f6a.js"><link rel="prefetch" href="/assets/js/64.d0f75a86.js"><link rel="prefetch" href="/assets/js/65.12e0c392.js"><link rel="prefetch" href="/assets/js/66.aac422ac.js"><link rel="prefetch" href="/assets/js/67.3ff890c6.js"><link rel="prefetch" href="/assets/js/68.c6d12518.js"><link rel="prefetch" href="/assets/js/69.455e0c09.js"><link rel="prefetch" href="/assets/js/7.375eddd0.js"><link rel="prefetch" href="/assets/js/70.73d975e7.js"><link rel="prefetch" href="/assets/js/71.66528e07.js"><link rel="prefetch" href="/assets/js/72.a608a326.js"><link rel="prefetch" href="/assets/js/73.b8ed0811.js"><link rel="prefetch" href="/assets/js/74.68f4db5d.js"><link rel="prefetch" href="/assets/js/8.a04b9d9b.js"><link rel="prefetch" href="/assets/js/9.04a00c43.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS笔记/工具.html" class="sidebar-link">工具</a></li><li><a href="/iOS笔记/计算机网络.html" class="sidebar-link">计算机网络</a></li><li><a href="/iOS笔记/架构.html" class="sidebar-link">架构</a></li><li><a href="/iOS笔记/视频播放器设计（基于FFmpeg）.html" class="sidebar-link">视频播放器设计（基于FFmpeg）</a></li><li><a href="/iOS笔记/视频常识.html" class="sidebar-link">视频常识</a></li><li><a href="/iOS笔记/数据结构与算法分析.html" class="sidebar-link">数据结构与算法分析</a></li><li><a href="/iOS笔记/算法.html" class="sidebar-link">算法</a></li><li><a href="/iOS笔记/音频常识.html" class="active sidebar-link">音频常识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#音频" class="sidebar-link">音频</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#音频文件的产生" class="sidebar-link">音频文件的产生</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#录音流程" class="sidebar-link">录音流程</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#采样位数" class="sidebar-link">采样位数</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#帧" class="sidebar-link">帧</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#周期" class="sidebar-link">周期</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#交错模式" class="sidebar-link">交错模式</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#非交错模式" class="sidebar-link">非交错模式</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#比特率" class="sidebar-link">比特率</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#信噪比" class="sidebar-link">信噪比</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#pcm数据三要素" class="sidebar-link">PCM数据三要素</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#库" class="sidebar-link">库</a></li><li class="sidebar-sub-header"><a href="/iOS笔记/音频常识.html#封装格式" class="sidebar-link">封装格式</a></li></ul></li><li><a href="/iOS笔记/音视频开发.html" class="sidebar-link">音视频开发</a></li><li><a href="/iOS笔记/直播.html" class="sidebar-link">直播</a></li><li><a href="/iOS笔记/App启动优化.html" class="sidebar-link">App启动优化</a></li><li><a href="/iOS笔记/Audio.html" class="sidebar-link">Audio</a></li><li><a href="/iOS笔记/AudioToolbox.html" class="sidebar-link">AudioToolbox</a></li><li><a href="/iOS笔记/AVFoundation.html" class="sidebar-link">AVFoundation</a></li><li><a href="/iOS笔记/C.html#.html" class="sidebar-link">C</a></li><li><a href="/iOS笔记/C.html#.html" class="sidebar-link">C#</a></li><li><a href="/iOS笔记/C++.html" class="sidebar-link">C++</a></li><li><a href="/iOS笔记/CoreAudio.html" class="sidebar-link">CoreAudio</a></li><li><a href="/iOS笔记/CoreVideo.html" class="sidebar-link">CoreVideo</a></li><li><a href="/iOS笔记/FFmpeg.html" class="sidebar-link">FFmpeg</a></li><li><a href="/iOS笔记/Flutter.html" class="sidebar-link">Flutter</a></li><li><a href="/iOS笔记/GPUImage.html" class="sidebar-link">GPUImage</a></li><li><a href="/iOS笔记/ijkPlayer.html" class="sidebar-link">ijkPlayer</a></li><li><a href="/iOS笔记/iOS细节.html" class="sidebar-link">iOS细节</a></li><li><a href="/iOS笔记/iOS性能优化.html" class="sidebar-link">iOS性能优化</a></li><li><a href="/iOS笔记/LFLiveKit.html" class="sidebar-link">LFLiveKit</a></li><li><a href="/iOS笔记/Metal.html" class="sidebar-link">Metal</a></li><li><a href="/iOS笔记/Objective-C.html" class="sidebar-link">Objective-C</a></li><li><a href="/iOS笔记/OpenGL相关概念.html" class="sidebar-link">OpenGL相关概念</a></li><li><a href="/iOS笔记/pthread.html" class="sidebar-link">pthread</a></li><li><a href="/iOS笔记/ReactNative.html" class="sidebar-link">React Native</a></li><li><a href="/iOS笔记/RunLoop.html" class="sidebar-link">RunLoop</a></li><li><a href="/iOS笔记/UI视图.html" class="sidebar-link">UI视图</a></li><li><a href="/iOS笔记/VideoToolbox.html" class="sidebar-link">VideoToolbox</a></li><li><a href="/iOS笔记/WebAssembly.html" class="sidebar-link">WebAssembly</a></li><li><a href="/iOS笔记/WebRTC.html" class="sidebar-link">WebRTC</a></li><li><a href="/iOS笔记/第三方.html" class="sidebar-link">第三方</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="音频常识"><a href="#音频常识" class="header-anchor">#</a> 音频常识</h1> <h2 id="音频"><a href="#音频" class="header-anchor">#</a> 音频</h2> <p>指人耳可以听到的声音频率在20HZ~20kHz之间的声波，称为音频。</p> <h2 id="音频文件的产生"><a href="#音频文件的产生" class="header-anchor">#</a> 音频文件的产生</h2> <h3 id="模拟信号"><a href="#模拟信号" class="header-anchor">#</a> 模拟信号</h3> <ul><li><p>PCM以后的数字信号，PCM时采样频率叫做sample rate。每一次采样可以得到若干采样数据，对应多个channel。每一个采样点得到的若干采样数据组合起来，叫做一个frame。若干frame组合起来叫做一个packet。</p> <ul><li>压缩、编码以后的音频文件</li></ul></li></ul> <h2 id="录音流程"><a href="#录音流程" class="header-anchor">#</a> 录音流程</h2> <h3 id="创建audiounit描述符audiocomponentdescription的对象acd"><a href="#创建audiounit描述符audiocomponentdescription的对象acd" class="header-anchor">#</a> 创建AudioUnit描述符AudioComponentDescription的对象acd</h3> <ul><li><p>找到合适的AudioUnit：AudioComponent component = AudioComponentFindNext(NULL, &amp;acd);</p> <ul><li><p>创建AudioUnit实例_componentInstance：AudioComponentInstanceNew(self.component, &amp;_componetInstance);</p> <ul><li>开启录音权限UInt32 flagOne = 1;</li></ul> <p>AudioUnitSetProperty(self.componetInstance, kAudioOutputUnitProperty_EnableIO, kAudioUnitScope_Input, 1, &amp;flagOne, sizeof(flagOne));</p> <div class="language- extra-class"><pre><code>  - 创建音频流的描述符AudioStreamBasicDescription desc

  	- 将音频流描述符添加到AudioUnit的输出单元AudioUnitSetProperty(self.componetInstance, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 1, &amp;desc, sizeof(desc));

  		- 创建音频回调结构体AURenderCallbackStruct cb;cb.inputProcRefCon = (__bridge void *)(self);
</code></pre></div><p>cb.inputProc = handleInputBuffer;持续不断的从handleInputBuffer回调函数中获取音频流</p> <div class="language- extra-class"><pre><code>  			- 将录音回调函数添加到AudioUnit的全局属性AudioUnitSetProperty(self.componetInstance, kAudioOutputUnitProperty_SetInputCallback, kAudioUnitScope_Global, 1, &amp;cb, sizeof(cb));

  			  录音回调，回调中使用AudioUnitRender播放

  				- 调用AudioUnitInitialize(self.componetInstance);给AudioUnit分配资源和准备处理音频，是线程安全的

  					- 开始录制AudioOutputUnitStart(self.componetInstance);

  			- 播放回调：AudioUnitSetProperty(_ioUnit, kAudioUnitProperty_SetRenderCallback, kAudioUnitScope_Output, 0, &amp;playCallBack, sizeof(playCallBack));
</code></pre></div></li></ul> <p>CheckStatus(status, @&quot;set renderCallBackError&quot;, YES);</p></li></ul> <h3 id="同时使用avaudiosession来管理音频设备这一系统的唯一资源-用来协调不同的app的工作。"><a href="#同时使用avaudiosession来管理音频设备这一系统的唯一资源-用来协调不同的app的工作。" class="header-anchor">#</a> 同时使用AVAudioSession来管理音频设备这一系统的唯一资源，用来协调不同的App的工作。</h3> <ul><li>是进行录音还是播放？</li> <li>当系统静音键按下时该如何表现？</li> <li>是从扬声器还是从听筒里面播放声音？</li> <li>插拔耳机后如何表现？</li> <li>来电话/闹钟响了后如何表现？</li> <li>其他音频App启动后如何表现？</li></ul> <h2 id="采样位数"><a href="#采样位数" class="header-anchor">#</a> 采样位数</h2> <p>即采样值或取样值（就是将采样样本幅度量化）。它是用来衡量声音波动变化的一个参数，也可以说是声卡的分辨率。它的数值越大，分辨率也就越高，所发出声音的能力越强。每个采样数据记录的是振幅, 采样精度取决于采样位数的大小，即采样位数越过，所能采集的音量范围就越广。</p> <h3 id="_1-字节-也就是8bit-只能记录-256-个数-也就是只能将振幅划分成-256-个等级"><a href="#_1-字节-也就是8bit-只能记录-256-个数-也就是只能将振幅划分成-256-个等级" class="header-anchor">#</a> 1 字节(也就是8bit) 只能记录 256 个数, 也就是只能将振幅划分成 256 个等级;</h3> <h3 id="_2-字节-也就是16bit-可以细到-65536-个数-这已是-cd-标准了"><a href="#_2-字节-也就是16bit-可以细到-65536-个数-这已是-cd-标准了" class="header-anchor">#</a> 2 字节(也就是16bit) 可以细到 65536 个数, 这已是 CD 标准了;</h3> <h3 id="_4-字节-也就是32bit-能把振幅细分到-4294967296-个等级-实在是没必要了"><a href="#_4-字节-也就是32bit-能把振幅细分到-4294967296-个等级-实在是没必要了" class="header-anchor">#</a> 4 字节(也就是32bit) 能把振幅细分到 4294967296 个等级, 实在是没必要了.</h3> <h2 id="帧"><a href="#帧" class="header-anchor">#</a> 帧</h2> <p>帧记录了一个声音单元，其长度为样本长度(采样位数)和通道数的乘积。</p> <h2 id="周期"><a href="#周期" class="header-anchor">#</a> 周期</h2> <p>音频设备一次处理所需要的帧数，对于音频设备的数据访问以及音频数据的存储，都是以此为单位。</p> <h2 id="交错模式"><a href="#交错模式" class="header-anchor">#</a> 交错模式</h2> <p>数字音频信号存储的方式。数据以连续帧的方式存放，即首先记录帧1的左声道样本和右声道样本，再开始帧2的记录</p> <h2 id="非交错模式"><a href="#非交错模式" class="header-anchor">#</a> 非交错模式</h2> <p>首先记录的是一个周期内所有帧的左声道样本，再记录所有右声道样本。</p> <h2 id="比特率"><a href="#比特率" class="header-anchor">#</a> 比特率</h2> <p>每秒的传输速率(位速, 也叫比特率)。如705.6kbps 或 705600bps, 其中的 b 是 bit, ps 是每秒的意思，表示每秒705600bit的容量。</p> <h2 id="信噪比"><a href="#信噪比" class="header-anchor">#</a> 信噪比</h2> <p>即分贝</p> <h3 id="_10lg-p1-p2"><a href="#_10lg-p1-p2" class="header-anchor">#</a> 10lg(P1/P2)</h3> <h2 id="pcm数据三要素"><a href="#pcm数据三要素" class="header-anchor">#</a> PCM数据三要素</h2> <h3 id="采样频率samplerate"><a href="#采样频率samplerate" class="header-anchor">#</a> 采样频率sampleRate</h3> <p>即取样频率, 指每秒钟取得声音样本的次数。采样频率越高,声音的质量也就越好,声音的还原也就越真实，但同时它占的资源比较多。由于人耳的分辨率很有限,太高的频率并不能分辨出来。</p> <p>22050 的采样频率是常用的, 44100已是CD音质, 超过48000或96000的采样对人耳已经没有意义。这和电影的每秒 24 帧图片的道理差不多。</p> <p>如果是双声道(stereo), 采样就是双份的, 文件也差不多要大一倍.</p> <p>常见的采样率为：8k、16k、32k、44.1k、48k</p> <h3 id="声道数channel"><a href="#声道数channel" class="header-anchor">#</a> 声道数channel</h3> <p>即声音的通道的数目。常有单声道和立体声之分，单声道的声音只能使用一个喇叭发声（有的也处理成两个喇叭输出同一个声道的声音），立体声可以使两个喇叭都发声（一般左右声道有分工） ，更能感受到空间效果，当然还有更多的通道数。</p> <h3 id="量化格式sampleformat"><a href="#量化格式sampleformat" class="header-anchor">#</a> 量化格式sampleFormat</h3> <p>通常16个比特</p> <h2 id="库"><a href="#库" class="header-anchor">#</a> 库</h2> <h3 id="fdk-aac"><a href="#fdk-aac" class="header-anchor">#</a> FDK_AAC</h3> <p>用来编码和解码AAC文件的开源库</p> <ul><li>AAC有很多种Profile，FDK_AAC几乎支持大部分Profile，并且支持CBR和VBR两种模式</li></ul> <h3 id="lame"><a href="#lame" class="header-anchor">#</a> LAME</h3> <p>mp3编码引擎，转码成mp3格式时，最常用的编码器就是LAME库</p> <h3 id="x264"><a href="#x264" class="header-anchor">#</a> X264</h3> <p>X264是一个开源的H.264/MPEG-4 AVC视频编码函数库，是最好的 有损视频编码器之一</p> <ul><li>支持CBR、VBR模式</li></ul> <h2 id="封装格式"><a href="#封装格式" class="header-anchor">#</a> 封装格式</h2> <h3 id="mp4a"><a href="#mp4a" class="header-anchor">#</a> mp4a</h3> <p><em>XMind - Trial Version</em></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/iOS笔记/算法.html" class="prev">
        算法
      </a></span> <span class="next"><a href="/iOS笔记/音视频开发.html">
        音视频开发
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9de76d75.js" defer></script><script src="/assets/js/2.98ea7a63.js" defer></script><script src="/assets/js/75.85059bdc.js" defer></script>
  </body>
</html>
